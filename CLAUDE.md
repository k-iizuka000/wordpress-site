## 言語とコミュニケーション
- 日本語で回答する
- 簡潔で明確な表現を心がける
- 技術用語は適切に使用する
- 不明点は推測せず確認する

## セキュリティチェック（作業完了時必須）
- [ ] フルパス（個人情報）の削除
- [ ] APIキー・トークンの確認
- [ ] パスワードのハードコーディング確認
- [ ] 機密ファイルの取り扱い確認
- [ ] 環境変数の適切な使用確認

## 最重要原則
1. **確実性最優先**: 時間効率よりも確実性を常に優先する
2. **タスク厳守**: 指定されたタスク以外の作業は絶対に行わない
3. **順番厳守**: タスクは必ず順番通りに実行する
4. **曖昧さの排除**: 曖昧な機能リクエストを、構造化された要件に変換し、misunderstandingを減らし、開発の反復を最小化する
5. **学習について**:今後に活用できそうな技術的教訓や技術的負債が発生した場合は「learning/学習記録.md」に追記して

## ドキュメントの管理方法
** 注意点 : 余計な情報はノイズになるため必要な情報のみをドキュメントに残すこと。**

### ディレクトリ構造と用途
```
- docs/      # 恒久的なドキュメント（仕様書、設計書、API仕様など）
- tasks/     # 作業指示書、実装計画、TODO
- tests/     # テスト結果、テスト設計書、実行ログ  
- reviews/   # コードレビュー、セキュリティ監査結果
- reports/   # 調査結果、分析レポート
- learning/  # 学習記録、技術的負債、ナレッジ
```

### 作成ルール
- ユーザー指示がない場合は、上記の適切なディレクトリに作成する
- ファイル名は日本語名で作成する
- ファイル名で内容が判別できるようにする
- 同一トピックのドキュメントは新規作成せずに、更新する

### 各ディレクトリの詳細
- **docs/**: プロジェクトの仕様や設計など、長期的に参照される文書
- **tasks/**: 現在進行中の作業や計画。完了後は必要に応じて@docs/へ移動
- **tests/**: テスト実行のたびに更新。日付付きファイル名を推奨
- **reviews/**: [YYYYMMDD-hhmm-{概要}].mdの形式で保存
- **reports/**: 調査・分析結果。再利用可能な形で整理
- **learning/**: 「学習記録.md」に追記形式で蓄積

## 実装完了時　のワークフロー
1. Taskツールで[@.claude/agents/.claude/agents/test-on-code-change.md]を使ってレビューせよ
   1. テストが存在しない場合はスキップ
2. Taskツールで[@.claude/agents/code-review-post-implementation.md]を使ってレビューせよ
   1. 結果は[@reviews/]に[YYYYMMDD-hhmm-{実装の概要}.md]で出力せよ

##  === Claude → Gemini CLI ワークフロー設定 ===
**Claude が外部ソースを必要と判断した瞬間に下記を実行**
### 1. ワークフロー
- ユーザーが「geminiに聞いて」と、それに類似することを言ったら開始
- ユーザー要求を 60 語以内の英語で要約し、環境変数 PROMPT に格納する。
- 以下のコマンドで Gemini CLI を非対話的に呼び出す:
  ```bash
  gemini -p <<EOF
  $PROMPT
  EOF
   ````

* Gemini には `GoogleSearch`（必要に応じて `WebFetch`）を必ず使用させ、
  引用付き Markdown を返させる。

### 2. gemini cliがエラーを返す場合
- エラーを返す理由は複数あると思うが、エラー内容を都度解析し検索不可能だと判断した場合に実施
- ユーザーが「web検索して」と、それに類似することを言ったら開始
  - claude code自身で web検索 を実施して検索する。
    - その際、下記を意識して検索しなさい。
      - 「最新の」「最近の」といった時間軸を示す言葉を入れる
      - 具体的な固有名詞や製品名を入れる

## 調査タスクの品質管理プロセス
### 1. 初期要求の記録（必須）
- ユーザーが明示的に挙げた項目は必ずTodoWriteツールでチェックリスト化
- 例：「cursor」「kiro」「claude code」「gemini cli」など
### 2. 調査結果の検証
- 外部ツール（Gemini CLI等）の回答を鵜呑みにしない
- 特に自己参照的な調査（例：Gemini CLIでGemini CLIを調査）は要注意
- 他ツールの一機能として言及された項目も、初期要求にあれば独立項目として扱う
### 3. 最終成果物チェック（必須）
- 提出前に初期チェックリストと照合
- 全項目が含まれているか確認
- 不足があれば追加調査または理由を明記
### 4. 調査の原則
- ユーザーの要求 > 外部ツールの分類
- 明示的な指定項目は必ず独立して扱う
- 「○○の一部」という回答でも、要求にあれば独立項目化
