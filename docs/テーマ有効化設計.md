# WordPressテーマ「kei-portfolio」有効化設計書

## 1. 現状分析

### 環境状況
- **WordPress稼働状況**: Docker環境でポート8090にて稼働中
- **コンテナ状態**: 
  - kei-portfolio-dev (WordPress): 正常稼働中
  - kei-portfolio-db (MariaDB): 正常稼働中
  - kei-portfolio-pma (phpMyAdmin): 正常稼働中

### テーマ状況
- **対象テーマ**: kei-portfolio
- **テーマ場所**: `/wordpress/wp-content/themes/kei-portfolio`
- **テーマ状態**: インストール済み・未有効化
- **現在のテーマ**: デフォルトテーマ（未確認）

### テーマファイル構成確認
- ✅ style.css: 存在（Theme Name: Kei Portfolio Pro）
- ✅ functions.php: 存在（必要なファイルをrequire）
- ✅ index.php: 存在（メインテンプレート）
- ✅ その他必要ファイル: inc/ディレクトリ内に各種機能ファイル存在

## 2. 有効化方法の設計

### 2.1 管理画面からの有効化（推奨方法）

#### 手順
1. WordPressにログイン（http://localhost:8090/wp-admin）
2. 外観 > テーマへ移動
3. 「Kei Portfolio Pro」を探す
4. 「有効化」ボタンをクリック

#### メリット
- GUIでの操作で確実
- WordPressの標準的な手順
- 有効化時のフックが適切に実行される

### 2.2 WP-CLIによる有効化（コマンドライン方法）

#### 手順
```bash
# Dockerコンテナ内でWP-CLIコマンドを実行
docker exec -it kei-portfolio-dev wp theme activate kei-portfolio --allow-root
```

#### メリット
- 自動化可能
- スクリプト化に適している
- 複数環境での一括設定に便利

### 2.3 データベース直接更新（緊急時のみ）

#### 手順
1. phpMyAdmin（http://localhost:8091）にアクセス
2. wp_optionsテーブルの以下を更新：
   - `template`: 'kei-portfolio'
   - `stylesheet`: 'kei-portfolio'

#### 注意点
- 最終手段として使用
- キャッシュクリアが必要な場合がある

## 3. 作業グループ分割

### グループ1: 事前準備（必須）
1. **バックアップ作成**
   - データベースのバックアップ
   - 現在のテーマ設定の記録
   
2. **環境確認**
   - Dockerコンテナの稼働確認
   - WordPressアクセス確認（http://localhost:8090）

3. **認証情報確認**
   - WordPress管理者アカウントの確認
   - ログイン可能性の検証

### グループ2: テーマ有効化
4. **テーマ有効化実行**
   - 管理画面からの有効化
   - または WP-CLIでの有効化

5. **有効化確認**
   - フロントエンド表示確認
   - 管理画面でのテーマ状態確認

### グループ3: 動作検証
6. **基本機能確認**
   - トップページ表示
   - 各テンプレート動作確認
   - メニュー・ウィジェット表示

7. **エラーチェック**
   - PHPエラーログ確認
   - ブラウザコンソールエラー確認
   - 404エラーなどの確認

### グループ4: 設定調整（オプション）
8. **初期設定**
   - パーマリンク設定
   - メニュー位置の設定
   - ウィジェット配置

9. **コンテンツ確認**
   - サンプルコンテンツの表示確認
   - カスタム投稿タイプの動作確認

10. **最終確認**
    - 全体的な動作確認
    - パフォーマンス確認

## 4. トラブルシューティング

### よくある問題と対処法

#### テーマが表示されない場合
- テーマディレクトリの権限確認
- style.cssのヘッダー情報確認
- functions.phpの構文エラー確認

#### 有効化後に白い画面になる場合
- PHPエラーログを確認
- メモリ制限の確認
- プラグインとの競合確認

#### スタイルが適用されない場合
- CSSファイルのパス確認
- wp_enqueue_styleの実装確認
- ブラウザキャッシュのクリア

## 5. 実行コマンド一覧

### Docker関連
```bash
# コンテナ状態確認
docker ps

# WordPressコンテナにアクセス
docker exec -it kei-portfolio-dev bash

# ログ確認
docker logs kei-portfolio-dev
```

### WP-CLI関連
```bash
# 現在のテーマ確認
docker exec -it kei-portfolio-dev wp theme list --allow-root

# テーマ有効化
docker exec -it kei-portfolio-dev wp theme activate kei-portfolio --allow-root

# テーマ状態確認
docker exec -it kei-portfolio-dev wp theme status kei-portfolio --allow-root
```

### トラブルシューティング
```bash
# PHPエラーログ確認
docker exec -it kei-portfolio-dev tail -f /var/log/apache2/error.log

# WordPressデバッグログ確認
docker exec -it kei-portfolio-dev tail -f /var/www/html/wp-content/debug.log

# パーミッション修正
docker exec -it kei-portfolio-dev chmod -R 755 /var/www/html/wp-content/themes/kei-portfolio
```

## 6. 成功基準

### 必須達成項目
- ✅ テーマが正常に有効化される
- ✅ フロントエンドが表示される
- ✅ 管理画面が正常に動作する
- ✅ PHPエラーが発生しない

### 推奨達成項目
- ✅ すべてのテンプレートが正常動作
- ✅ カスタム投稿タイプが機能
- ✅ スタイルが正しく適用
- ✅ JavaScriptが正常動作

## 7. 次のステップ

テーマ有効化完了後：
1. コンテンツの投入
2. メニュー・ウィジェットの設定
3. カスタマイザーでの外観調整
4. SEO設定
5. パフォーマンス最適化

## 8. 注意事項

- 作業前に必ずバックアップを取得すること
- 本番環境では事前にステージング環境でテストすること
- エラーが発生した場合は、すぐに元のテーマに戻せる準備をしておくこと
- デバッグモードを有効にして作業を行うこと（docker-compose.ymlで設定済み）

---

*作成日: 2025-08-07*
*作成者: WordPress開発チーム*