# React to WordPress 変換ガイドライン

## 1. JSX → PHP変換ルール

### 基本的な変換パターン

#### コンポーネント構造
```jsx
// React (JSX)
export default function Component() {
  return (
    <div className="container">
      <h1>{title}</h1>
    </div>
  );
}
```

```php
// WordPress (PHP)
<div class="container">
  <h1><?php echo esc_html($title); ?></h1>
</div>
```

#### 条件付きレンダリング
```jsx
// React
{isVisible && <div>Content</div>}
{condition ? <div>A</div> : <div>B</div>}
```

```php
// WordPress
<?php if ($isVisible) : ?>
  <div>Content</div>
<?php endif; ?>

<?php echo $condition ? '<div>A</div>' : '<div>B</div>'; ?>
```

#### 配列のマッピング
```jsx
// React
{items.map((item, index) => (
  <div key={index}>{item.name}</div>
))}
```

```php
// WordPress
<?php foreach ($items as $index => $item) : ?>
  <div><?php echo esc_html($item['name']); ?></div>
<?php endforeach; ?>
```

## 2. React Hooks → PHP/JavaScript実装

### useState → JavaScript変数 + DOM操作
```jsx
// React
const [isOpen, setIsOpen] = useState(false);
```

```javascript
// WordPress (JavaScript)
let isOpen = false;

function toggleMenu() {
  isOpen = !isOpen;
  const menu = document.getElementById('menu');
  menu.classList.toggle('hidden', !isOpen);
}
```

### useEffect → DOMContentLoaded / WordPress Hooks
```jsx
// React
useEffect(() => {
  // 初期化処理
}, []);
```

```javascript
// WordPress (JavaScript)
document.addEventListener('DOMContentLoaded', function() {
  // 初期化処理
});
```

```php
// WordPress (PHP Hook)
add_action('wp_enqueue_scripts', function() {
  // スクリプトの登録
});
```

## 3. Tailwind CSS → WordPress統合

### セットアップ手順

1. **package.jsonに追加**
```json
{
  "devDependencies": {
    "tailwindcss": "^3.0.0",
    "postcss": "^8.0.0",
    "autoprefixer": "^10.0.0"
  }
}
```

2. **tailwind.config.js設定**
```javascript
module.exports = {
  content: [
    './wp-content/themes/kei-portfolio/**/*.php',
    './wp-content/themes/kei-portfolio/**/*.js'
  ],
  theme: {
    extend: {
      fontFamily: {
        'pacifico': ['Pacifico', 'cursive'],
      }
    }
  }
}
```

3. **ビルドプロセス**
```bash
npx tailwindcss -i ./src/input.css -o ./style.css --watch
```

### クラス名の直接使用
- ReactのclassName属性 → PHPのclass属性
- 動的クラスはPHP条件文で制御

```php
<div class="<?php echo $isActive ? 'bg-blue-600' : 'bg-gray-400'; ?> px-4 py-2">
```

## 4. ルーティングの対応表

### Next.js App Router → WordPress テンプレート

| Next.js パス | WordPress テンプレート | 用途 |
|------------|---------------------|------|
| `/app/page.tsx` | `front-page.php` | トップページ |
| `/app/about/page.tsx` | `page-about.php` | 固定ページ（About） |
| `/app/portfolio/page.tsx` | `archive-project.php` | プロジェクト一覧 |
| `/app/portfolio/[slug]` | `single-project.php` | プロジェクト詳細 |
| `/app/skills/page.tsx` | `page-skills.php` | 固定ページ（Skills） |
| `/app/contact/page.tsx` | `page-contact.php` | 固定ページ（Contact） |
| `/app/not-found.tsx` | `404.php` | 404エラーページ |
| `/app/layout.tsx` | `header.php` + `footer.php` | 共通レイアウト |

### Link コンポーネント → WordPress関数

```jsx
// React (Next.js)
<Link href="/about">About</Link>
<Link href="/portfolio">Portfolio</Link>
```

```php
// WordPress
<a href="<?php echo esc_url(home_url('/about')); ?>">About</a>
<a href="<?php echo esc_url(get_post_type_archive_link('project')); ?>">Portfolio</a>
```

## 5. 状態管理の移行戦略

### クライアントサイド状態
- **React State** → **JavaScript変数 + LocalStorage**
- モバイルメニュー、タブ切り替えなど

### サーバーサイド状態
- **React Props** → **WordPress PHP変数**
- **getServerSideProps** → **WP_Query**

### グローバル状態
- **Context API** → **WordPress Options API + Customizer**
- サイト設定、テーマ設定など

```php
// WordPress Options API
$hero_title = get_theme_mod('hero_title', 'デフォルトタイトル');
$site_settings = get_option('kei_portfolio_settings');
```

## 6. 画像とアセットの処理

### Next.js Image → WordPress 画像関数

```jsx
// React (Next.js)
import Image from 'next/image';
<Image src="/image.jpg" alt="Description" width={400} height={300} />
```

```php
// WordPress
<?php if (has_post_thumbnail()) : ?>
  <?php the_post_thumbnail('project-thumbnail', array(
    'alt' => get_the_title(),
    'class' => 'w-full h-48 object-cover'
  )); ?>
<?php endif; ?>
```

### 外部画像URL
- Readdy.ai API画像 → WordPress メディアライブラリへアップロード
- または、外部URLをそのまま使用（パフォーマンス注意）

## 7. フォーム処理

### React フォーム → WordPress フォーム

```jsx
// React
const handleSubmit = async (e) => {
  e.preventDefault();
  // API呼び出し
};
```

```php
// WordPress (Contact Form 7 または カスタム実装)
add_action('wp_ajax_submit_contact_form', 'handle_contact_form');
add_action('wp_ajax_nopriv_submit_contact_form', 'handle_contact_form');

function handle_contact_form() {
  // フォーム処理
  wp_send_json_success($response);
}
```

## 8. SEO・メタデータ

### Next.js Metadata → WordPress SEO

```jsx
// React (Next.js)
export const metadata = {
  title: 'Page Title',
  description: 'Page description'
};
```

```php
// WordPress (functions.php)
add_action('wp_head', function() {
  if (is_page('about')) {
    echo '<meta name="description" content="About page description">';
  }
});
```

## 9. 開発時の注意事項

### エスケープ処理
- 必ず適切なエスケープ関数を使用
  - `esc_html()` - HTML出力
  - `esc_attr()` - 属性値
  - `esc_url()` - URL
  - `wp_kses_post()` - 許可されたHTMLタグ

### パフォーマンス最適化
- 不要なReactランタイムの削除
- JavaScriptは必要最小限に
- WordPress標準のキャッシュ機能活用
- 画像の遅延読み込み有効化

### セキュリティ
- Nonce検証の実装
- ユーザー権限の確認
- SQLインジェクション対策（prepared statements）
- XSS対策（エスケープ処理）

## 10. テスト手順

1. **PHP構文チェック**
   ```bash
   php -l template-file.php
   ```

2. **ブラウザ確認**
   - Chrome DevTools でレスポンシブ確認
   - JavaScript コンソールエラーチェック

3. **WordPress Debug モード**
   ```php
   define('WP_DEBUG', true);
   define('WP_DEBUG_LOG', true);
   define('WP_DEBUG_DISPLAY', false);
   ```

4. **パフォーマンス測定**
   - PageSpeed Insights
   - GTmetrix
   - WordPress Query Monitor プラグイン